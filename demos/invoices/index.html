<!DOCTYPE html><html lang="fr"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Invoice → JSON → CSV</title>
<link rel="icon" href="/assets/logo.jpg">
<link rel="apple-touch-icon" href="/assets/logo.jpg">
<link rel="stylesheet" href="/styles.css?v=final3">
<style>
  .wrap{max-width:1180px;margin:0 auto;padding:24px 20px}
  .grid{display:grid;grid-template-columns:1fr 1.1fr;gap:28px}
  h1{font-size:34px;margin:10px 0 18px}
  .panel{background:#0f1117;border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:18px}
  pre{margin:0;white-space:pre-wrap;word-break:break-word;color:#e6edf3}
  .btn{display:inline-block;background:#6366f1;color:#fff;border:none;border-radius:12px;padding:10px 16px;font-weight:600;box-shadow:0 6px 20px rgba(99,102,241,.35);cursor:pointer;margin-top:14px}
  .icon{margin-top:12px}
</style>
</head><body>
<header class="site-header"><div class="container header-inner">
  <a class="brand" href="/" aria-label="Hestia Aura">
    <img src="/assets/logo.jpg" alt="logo" class="brand-mark"><span class="brand-name">Hestia <strong>Aura</strong></span>
  </a>
  <nav class="nav"><a href="/">Accueil</a><a href="/showcase.html">Showcase</a><a class="btn btn--sm" href="/en/">EN</a></nav>
</div></header>

<main class="wrap">
  <h1>Invoice → JSON → CSV</h1>
  <div class="grid">
    <div>
      <!-- Icône document inline (pas d'image externe) -->
      <svg class="icon" width="120" height="150" viewBox="0 0 96 120" aria-hidden="true" style="opacity:.85">
        <rect x="14" y="10" width="68" height="100" rx="10" ry="10"
              fill="none" stroke="rgba(255,255,255,.6)" stroke-width="4"/>
        <polyline points="60,10 82,10 82,32" fill="none"
              stroke="rgba(255,255,255,.6)" stroke-width="4"/>
        <line x1="26" y1="46" x2="70" y2="46" stroke="rgba(255,255,255,.6)" stroke-width="4"/>
        <line x1="26" y1="62" x2="70" y2="62" stroke="rgba(255,255,255,.6)" stroke-width="4"/>
        <line x1="26" y1="78" x2="54" y2="78" stroke="rgba(255,255,255,.6)" stroke-width="4"/>
      </svg>
    </div>

    <div class="panel">
      <pre id="json"></pre>
      <button id="dl" class="btn">Download CSV</button>
    </div>
  </div>
</main>

<script>
  const data = {
    supplier: "ACME SA",
    invoice_number: "FV-2024-031",
    date: "2024-08-01",
    total: 1290.5,
    vat: 107.54,
    currency: "CHF",
    lines: [
      { desc: "Support package", qty: 1, unit: 800, amount: 800 },
      { desc: "Licenses (3)",   qty: 3, unit: 140.17, amount: 420.51 },
      { desc: "Shipping",       qty: 1, unit: 69.99,  amount: 69.99 }
    ]
  };

  document.getElementById('json').textContent = JSON.stringify(data, null, 2);

  function toCSV(inv){
    const rows = [['desc','qty','unit','amount']];
    for(const l of inv.lines){ rows.push([l.desc,l.qty,l.unit,l.amount]); }
    return rows.map(r => r.map(v => `"${String(v).replace(/"/g,'""')}"`).join(',')).join('\n');
  }

  document.getElementById('dl').addEventListener('click', () => {
    const csv = toCSV(data);
    const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'invoice_lines.csv';
    a.click();
    URL.revokeObjectURL(a.href);
  });
</script>
</body></html>
